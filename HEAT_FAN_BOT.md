# üî• Miami Heat Fan Bot - Extremely Opinionated Live Game Commentary

## Overview

This is a **completely separate bot** from the main NBA agent. While the main agent posts professional box scores and injury reports, this bot is an **unhinged Miami Heat superfan** that posts controversial, emotional takes during live Heat games.

## What It Does

- **Monitors live Heat games** in real-time
- **Compares box scores** between checks to see what changed
- **Posts spicy tweets** reacting to player performance:
  - **Roasts players** brutally when they mess up (missed shots, turnovers)
  - **Praises players** with wild exaggeration when they do well
  - Uses creative insults, ALL CAPS, emojis, and zero chill
- **Generates random shitposts** using X AI (Grok) when:
  - No live game is happening
  - Game is boring with no interesting updates
  - Keeps your feed active with unpredictable Heat takes 24/7!

## Files

### Production Files
- `heat_fan_agent.py` - The AI agent with unhinged personality
- `heat_fan_mcp_server.py` - MCP server with live game tools

### Test Files
- `test_heat_fan_mcp_server.py` - Test server with dummy evolving game data

## Installation

All dependencies are already installed from the main bot:
```bash
# Already have these from requirements.txt:
# - nba_api
# - tweepy
# - anthropic
# - sqlalchemy
# - loguru
# - openai (for X AI / Grok integration)
```

## Configuration

### Required API Keys

Add to your `.env` file:

```bash
# Anthropic API Key (required - Claude orchestrates the bot)
ANTHROPIC_API_KEY=your_anthropic_key_here

# Twitter API Keys (required - for posting tweets)
TWITTER_API_KEY=your_key_here
TWITTER_API_SECRET=your_secret_here
TWITTER_ACCESS_TOKEN=your_token_here
TWITTER_ACCESS_TOKEN_SECRET=your_token_secret_here
TWITTER_BEARER_TOKEN=your_bearer_token_here

# X AI API Key (optional but recommended - for random shitposts)
XAI_API_KEY=your_xai_key_here
```

### X AI (Grok) Integration

**What is it?**  
The bot uses X AI's Grok model to generate random, unpredictable shitposts when:
- No live Heat game is happening
- Game is boring with no interesting box score updates

**Why use Grok?**  
- Has access to latest Twitter/X data
- More unpredictable and creative than scripted takes
- Keeps your feed active 24/7, not just during games

**Get your API key:**  
1. Go to https://console.x.ai
2. Create an account / sign in
3. Generate an API key
4. Add it to your `.env` file as `XAI_API_KEY`

**Note:** If you don't add `XAI_API_KEY`, the bot will skip random shitposts and only post during live games with interesting updates.

## Usage

### Test Mode (Recommended First)

Test mode uses dummy data that evolves to simulate different scenarios:
- **Check 1**: First baseline snapshot (no tweet)
- **Check 2**: Bam misses 3 shots in a row ‚Üí Bot roasts him
- **Check 3**: Jimmy scores 10 points ‚Üí Bot praises wildly
- **Check 4**: Tyler Herro bricks 5 shots ‚Üí More roasting
- **Check 5**: Bam has a redemption arc ‚Üí Bot forgives him

**Important:** Use **loop mode** to see multiple checks and tweets! Single runs only save the first snapshot.

```bash
# RECOMMENDED: Continuous mode - checks every 1 minute (to see tweets quickly)
python heat_fan_agent.py loop 1 --test

# Press Ctrl+C after seeing a few tweets (5-10 minutes)

# Or check every 3 minutes
python heat_fan_agent.py loop 3 --test
```

### Production Mode (Live Games)

```bash
# Single check for live Heat game
python heat_fan_agent.py

# Continuous mode - checks every 3 minutes (recommended during games)
python heat_fan_agent.py loop 3

# Check every 5 minutes
python heat_fan_agent.py loop 5
```

## Bot Personality

The bot uses Claude with this personality:

### Roasting Examples (when players mess up):
```
"BAM BRICKED 3 STRAIGHT ü§° BENCH THIS MAN"

"TYLER HER-NO CANT HIT ANYTHING üóëÔ∏è 0-5 GET HIM OUT"

"Bam Ade-brick-o strikes again üíÄ TRADE HIM"
```

### Praising Examples (when players do well):
```
"JIMMY IS LITERALLY MJ üî•üî•üî• 20 PTS THIS QUARTER"

"BAM IS THE GREATEST CENTER ALIVE üëë UNSTOPPABLE"

"TYLER HERRO ON FIRE üí™ 3/3 FROM THREE HE'S HIM"
```

### Random Shitpost Examples (generated by Grok when no game/boring game):
```
"Breaking: Pat Riley trades Bam for a washing machine. Team chemistry improves immediately ü§°"

"Tyler Herro thinks he's Kobe but shoots like my grandma üóëÔ∏è"

"Heat culture is just sweating in the gym and pretending it's working üò§"

"Bam Adebayo getting paid $200M to set screens ü§° MAX MY ASS"
```

**Note:** Tweets are kept SHORT (100-150 chars) for maximum shitpost energy!

### Safety Rules
The bot will NEVER joke about:
- Death, dying, killing, or violence
- Race or discrimination
- Anything that violates Twitter's TOS

## How It Works

### 1. Check for Live Game
```python
get_live_heat_game()  # Returns game info if Heat are playing
```

### 2. Get Current Box Score
```python
get_heat_box_score(game_id)  # Returns all Heat player stats
```

### 3. Compare to Last Snapshot
```python
compare_box_scores(game_id, current_stats)
# Returns what changed since last check:
# - Points added/missed shots
# - Rebounds/assists/turnovers
```

### 4. Analyze & React
Claude analyzes the changes with its opinionated personality:
- **3+ missed shots** ‚Üí Roast the player
- **6+ points added** ‚Üí Praise wildly  
- **Multiple turnovers** ‚Üí Question their existence
- **Dominant performance** ‚Üí Crown them as GOAT

### 5. Post Tweet
```python
post_heat_tweet(tweet_text, game_id, snapshot_id)
```

### 6. Save Snapshot
```python
save_snapshot(...)  # Save current state for next comparison
```

## Database

The bot uses a new table `live_game_snapshots` to track:
- Game state at each check (score, period, clock)
- Full box score JSON for comparison
- Tweet IDs for posted reactions
- Timestamps to prevent spam

## Safety Features

### Rate Limiting
- Won't tweet more than once every 5 minutes (configurable)
- Uses `check_recent_heat_tweets()` to prevent spam

### Smart Tweeting
- Only tweets when something **interesting** happened
- Ignores minor stat changes
- Requires significant events (big runs, meltdowns, etc.)

## Running Both Bots

You can run the Heat fan bot AND the main NBA agent simultaneously:

```bash
# Terminal 1: Main NBA agent (box scores + injuries)
python ai_agent.py loop 5

# Terminal 2: Heat fan bot (live game reactions)
python heat_fan_agent.py loop 3
```

They use separate:
- MCP servers
- Database tables  
- Tweet posting logic

No conflicts!

## Example Output

```
============================================================
üî• MIAMI HEAT FAN BOT - EXTREMELY OPINIONATED üî•
============================================================
‚úÖ API key found
üîå Connecting to Heat Fan MCP server (LIVE)...
‚úÖ Connected to MCP server
‚úÖ Loaded 6 tools

============================================================
üéØ Checking for live Heat game...
============================================================

üîß Heat Fan Bot is checking stats...

============================================================
üî• WOULD POST TWEET:
============================================================
BAM ADEBAYO JUST MISSED 3 SHOTS IN A ROW ü§° 0 POINTS ON 0-3 
SHOOTING MY EYES ARE BLEEDING someone tell him this is 
basketball not volleyball üóëÔ∏èüíÄ
============================================================

============================================================
üî• Heat Fan's Take:
============================================================
BAM IS SELLING RIGHT NOW! Just posted my take on Twitter. 
This man better turn it around in the 2nd half or I'm 
calling for a trade! üò§üî•
============================================================
```

## Customization

### Change Personality
Edit the `system_prompt` in `heat_fan_agent.py` (lines 69-130) to adjust:
- Tone (more/less aggressive)
- Emoji usage
- Roasting vs praising threshold
- Language style

### Change Check Interval
```bash
# Check every 2 minutes (more reactive)
python heat_fan_agent.py loop 2

# Check every 10 minutes (less spam)
python heat_fan_agent.py loop 10
```

### Add More Players
The bot automatically detects all Heat players from the box score. No configuration needed.

## Tips

1. **Run in loop mode during games**: `python heat_fan_agent.py loop 3`
2. **Test first**: Always test with `--test` to see personality
3. **Monitor terminal**: Watch Claude's reasoning in real-time
4. **Adjust interval**: 3-5 minutes is good for live games
5. **Check database**: SQLite `live_game_snapshots` table shows history

## Troubleshooting

### "No live Heat game"
- Heat aren't playing right now
- Or game hasn't started yet (pre-game)
- Or game is already finished

### Bot not tweeting
- Nothing interesting changed since last check
- Or recently tweeted (5 min cooldown)
- Or first check (needs baseline snapshot)

### "Rate limit exceeded"
- Twitter API rate limit hit
- Wait or reduce check frequency

## Advanced: Modify Scenarios

Edit `test_heat_fan_mcp_server.py` to create custom test scenarios:

```python
# Line 43-62: Modify PLAYER_STATS evolution
elif check == 6:
    # Create your own scenario
    PLAYER_STATS["Jimmy Butler"]["points"] += 15  # Jimmy goes nuclear
    PLAYER_STATS["Bam Adebayo"]["turnovers"] += 3  # Bam disaster
```

Then run with `--test` to see bot's reaction!

## Production Recommendations

1. Run during Heat games only (auto-detects)
2. Use 3-5 minute intervals
3. Monitor first few runs to tune personality
4. Have fun with it! üî•

## Comparison to Main Bot

| Feature | Main NBA Agent | Heat Fan Bot |
|---------|---------------|--------------|
| **Focus** | All NBA teams | Miami Heat only |
| **Tone** | Professional | Unhinged |
| **Timing** | Completed games | Live games |
| **Frequency** | Once per game | Every 3-5 min |
| **Purpose** | Info/stats | Entertainment/reaction |
| **Injuries** | Yes | No |
| **Box Scores** | Final | Live updates |

Both bots can run simultaneously without conflicts!

